# quantclassic data_loader - å¤šæ•°æ®æºé›†æˆ

## å¿«é€Ÿé“¾æ¥

ğŸ“– **æ–‡æ¡£**
- [ClickHouse é›†æˆæŒ‡å—](./CLICKHOUSE_INTEGRATION_GUIDE.md) - è¯¦ç»†ä½¿ç”¨æ•™ç¨‹
- [é›†æˆå®Œæˆæ€»ç»“](./INTEGRATION_SUMMARY.md) - æŠ€æœ¯å®ç°æ€»ç»“

ğŸ’» **ç¤ºä¾‹ä»£ç **
- [example_clickhouse.py](./example_clickhouse.py) - å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

âš™ï¸ **é…ç½®æ–‡ä»¶**
- [config_clickhouse.yaml](./config_clickhouse.yaml) - ClickHouse é…ç½®æ¨¡æ¿
- [config.yaml](./config.yaml) - é€šç”¨é…ç½®æ¨¡æ¿

## æ ¸å¿ƒæ¨¡å—

| æ¨¡å— | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| ClickHouse æ•°æ®è·å–å™¨ | `clickhouse_fetcher.py` | å°è£… quantchdbï¼Œè·å– ETF æ•°æ® |
| å­—æ®µæ˜ å°„å™¨ | `field_mapper.py` | å­—æ®µæ ‡å‡†åŒ–å’Œç±»å‹è½¬æ¢ |
| ç»Ÿä¸€æ•°æ®æº | `unified_data_source.py` | å¤šæ•°æ®æºç»Ÿä¸€æ¥å£ |
| é…ç½®ç®¡ç† | `config_manager.py` | é…ç½®åŠ è½½å’ŒéªŒè¯ |

## 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install quantchdb
```

### 2. é…ç½®æ•°æ®æº
```python
from quantclassic.data_loader import ConfigManager, UnifiedDataSource

# åˆ›å»ºé…ç½®
config = ConfigManager()
config.data_source.source = 'clickhouse'
config.data_source.clickhouse_config = {
    'host': '10.13.66.5',
    'port': 20108,
    'user': 'etf_visitor',
    'password': 'etf_lh_2025',
    'database': 'etf'
}
config.time.start_date = '2024-11-01'
config.time.end_date = '2024-11-23'
```

### 3. è·å–æ•°æ®
```python
# åˆ›å»ºæ•°æ®æº
data_source = UnifiedDataSource(config)

# è·å– ETF æ•°æ®ï¼ˆå·²è‡ªåŠ¨æ ‡å‡†åŒ–ï¼‰
df = data_source.get_all_daily_data()

print(f"æ•°æ®å½¢çŠ¶: {df.shape}")
print(f"æ ‡å‡†å­—æ®µ: {df.columns.tolist()}")
```

### 4. ä¸ CompBase é›†æˆ
```python
from CompBase import BaseResearcher

class MyStrategy(BaseResearcher, ...):
    def load_data_all(self, start_date, end_date):
        # ä½¿ç”¨ quantclassic è·å–æ ‡å‡†åŒ–æ•°æ®
        self.config.time.start_date = start_date
        self.config.time.end_date = end_date
        return self.data_source.get_all_daily_data()
```

## æ”¯æŒçš„æ•°æ®æº

| æ•°æ®æº | é…ç½®å€¼ | æ•°æ®ç±»å‹ | çŠ¶æ€ |
|--------|--------|----------|------|
| ç±³ç­ (RQ) | `rq` | A è‚¡ | âœ… å·²æ”¯æŒ |
| ClickHouse | `clickhouse` | ETF | âœ… å·²æ”¯æŒ |
| Tushare | `tushare` | A è‚¡ | ğŸš§ è®¡åˆ’ä¸­ |

## å­—æ®µæ ‡å‡†åŒ–

æ‰€æœ‰æ•°æ®æºè¿”å›ç»Ÿä¸€çš„æ ‡å‡†å­—æ®µï¼š

```python
{
    'order_book_id': 'è‚¡ç¥¨ä»£ç ',
    'trade_date': 'äº¤æ˜“æ—¥æœŸ',
    'open': 'å¼€ç›˜ä»·',
    'high': 'æœ€é«˜ä»·',
    'low': 'æœ€ä½ä»·',
    'close': 'æ”¶ç›˜ä»·',
    'vol': 'æˆäº¤é‡',
    'amount': 'æˆäº¤é¢',
    'pe': 'å¸‚ç›ˆç‡',
    'pb': 'å¸‚å‡€ç‡',
    'total_mv': 'æ€»å¸‚å€¼',
    'circ_mv': 'æµé€šå¸‚å€¼',
    # ... æ›´å¤šå­—æ®µ
}
```

## è¿è¡Œç¤ºä¾‹

```bash
cd /home/u2025210237/jupyterlab/quantclassic/data_loader
python example_clickhouse.py
```

## æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CompBase      â”‚  ç­–ç•¥æ¡†æ¶
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  quantclassic.data_loader      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  UnifiedDataSource       â”‚  â”‚  ç»Ÿä¸€æ¥å£
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚           â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚ ClickHouseFetcherâ”‚  â”‚  DataFetcher   â”‚
â”‚  â”‚  (quantchdb)     â”‚  â”‚     (RQ)       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚           â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”
â”‚  â”‚       FieldMapper                â”‚  å­—æ®µæ ‡å‡†åŒ–
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä¸»è¦ç‰¹æ€§

âœ¨ **ç»Ÿä¸€æ¥å£** - ä¸€å¥—ä»£ç æ”¯æŒå¤šæ•°æ®æº  
ğŸ”„ **è‡ªåŠ¨æ˜ å°„** - å­—æ®µè‡ªåŠ¨æ ‡å‡†åŒ–  
ğŸ“Š **ç±»å‹å®‰å…¨** - æ•°æ®ç±»å‹è‡ªåŠ¨è½¬æ¢  
ğŸ¯ **æ˜“äºé›†æˆ** - ä¸ CompBase æ— ç¼å¯¹æ¥  
âš¡ **æ€§èƒ½ä¼˜åŒ–** - æ‰¹é‡è·å–ï¼Œå‡å°‘è¯·æ±‚  

## ç‰ˆæœ¬å†å²

- **v1.1.0** (2024-11-23)
  - âœ… æ·»åŠ  ClickHouse æ•°æ®æºæ”¯æŒ
  - âœ… å®ç°å­—æ®µè‡ªåŠ¨æ˜ å°„
  - âœ… åˆ›å»ºç»Ÿä¸€æ•°æ®æºæ¥å£
  - âœ… å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹

- **v1.0.0**
  - åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒç±³ç­æ•°æ®æº

## è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ï¼

## License

MIT License
