"""
HybridGraph æ¨¡å‹æ¶æ„å¯è§†åŒ–

å±•ç¤ºæ¨¡å‹çš„å±‚æ¬¡ç»“æ„å’Œæ•°æ®æµ
"""


def print_architecture():
    """æ‰“å°æ¨¡å‹æ¶æ„"""
    
    architecture = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    HybridGraph æ¨¡å‹æ¶æ„ (RNN+Attention+GAT)                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              è¾“å…¥æ•°æ®                                      â”‚
â”‚  â€¢ é‡ä»·æ•°æ®: [batch, seq_len, d_feat]                                     â”‚
â”‚  â€¢ åŸºæœ¬é¢æ•°æ® (å¯é€‰): [batch, funda_dim]                                   â”‚
â”‚  â€¢ é‚»æ¥çŸ©é˜µ (å¯é€‰): [batch, batch]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¨¡å— 1: æ—¶åºæå–å™¨ (TemporalBlock)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  RNN (LSTM/GRU)                                                    â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å…¥: [batch, seq_len, d_feat]                                  â”‚  â”‚
â”‚  â”‚  â€¢ éšè—å±‚: rnn_hidden                                              â”‚  â”‚
â”‚  â”‚  â€¢ å±‚æ•°: rnn_layers                                                â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å‡º: [batch, seq_len, rnn_hidden]                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Self-Attention (å¯é€‰)                                             â”‚  â”‚
â”‚  â”‚  â€¢ è®¡ç®—æ³¨æ„åŠ›æƒé‡: [batch, seq_len, 1]                             â”‚  â”‚
â”‚  â”‚  â€¢ åŠ æƒæ±‚å’Œ: Î£(rnn_out Ã— weights)                                  â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å‡º: [batch, rnn_hidden]                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                            â”‚
â”‚  âœ¨ ä½œç”¨: æ•æ‰å•åªè‚¡ç¥¨çš„æ—¶åºè§„å¾‹å’Œå…³é”®æ—¶é—´ç‚¹                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç‰¹å¾èåˆ (å¯é€‰: æ‹¼æ¥åŸºæœ¬é¢)                           â”‚
â”‚  â€¢ æ—¶åºç‰¹å¾: [batch, rnn_hidden]                                          â”‚
â”‚  â€¢ åŸºæœ¬é¢ç‰¹å¾: [batch, funda_dim]                                         â”‚
â”‚  â€¢ æ‹¼æ¥å: [batch, rnn_hidden + funda_dim]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¨¡å— 2: æˆªé¢äº¤äº’å™¨ (GraphBlock - GAT)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¤šå¤´æ³¨æ„åŠ› (Multi-Head Attention)                                  â”‚  â”‚
â”‚  â”‚  â€¢ å¤´æ•°: gat_heads                                                 â”‚  â”‚
â”‚  â”‚  â€¢ æ¯å¤´ç»´åº¦: gat_hidden / gat_heads                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¯¹æ¯åªè‚¡ç¥¨ i:                                                      â”‚  â”‚
â”‚  â”‚    1. çº¿æ€§å˜æ¢: h_i = W Ã— x_i                                      â”‚  â”‚
â”‚  â”‚    2. è®¡ç®—æ³¨æ„åŠ›: Î±_ij = Attention(h_i, h_j)                       â”‚  â”‚
â”‚  â”‚    3. ä»…ä¿ç•™é‚»å±…: Î±_ij = Î±_ij if A_ij=1 else 0                     â”‚  â”‚
â”‚  â”‚    4. å½’ä¸€åŒ–: Î±_ij = softmax(Î±_ij)                                 â”‚  â”‚
â”‚  â”‚    5. èšåˆ: h'_i = Î£(Î±_ij Ã— h_j)                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é‚»æ¥çŸ©é˜µ (Adjacency Matrix)                                       â”‚  â”‚
â”‚  â”‚  â€¢ Standard GAT: åŸºäºè¡Œä¸šåˆ†ç±»                                      â”‚  â”‚
â”‚  â”‚    â†’ A_ij = 1 if åŒè¡Œä¸š, else 0                                    â”‚  â”‚
â”‚  â”‚  â€¢ Correlation GAT: åŸºäºæ”¶ç›Šç‡ç›¸å…³æ€§                                â”‚  â”‚
â”‚  â”‚    â†’ A_ij = 1 if jæ˜¯içš„top-kæœ€ç›¸å…³è‚¡ç¥¨, else 0                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                            â”‚
â”‚  âœ¨ ä½œç”¨: æ•æ‰è‚¡ç¥¨é—´çš„æˆªé¢å…³è” (è¡Œä¸šè”åŠ¨/ç›¸å…³æ€§)                           â”‚
â”‚  ğŸ“Š è¾“å‡º: [batch, gat_hidden]                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç‰¹å¾æ‹¼æ¥ (Feature Concatenation)                      â”‚
â”‚  â€¢ æ—¶åºç‰¹å¾: [batch, rnn_hidden]                                          â”‚
â”‚  â€¢ å›¾ç‰¹å¾: [batch, gat_hidden]                                            â”‚
â”‚  â€¢ åŸºæœ¬é¢ç‰¹å¾ (å¯é€‰): [batch, funda_dim]                                   â”‚
â”‚  â€¢ æ‹¼æ¥å: [batch, rnn_hidden + gat_hidden + funda_dim]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ¨¡å— 3: èåˆé¢„æµ‹å™¨ (FusionBlock - MLP)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å¤šå±‚æ„ŸçŸ¥æœº (MLP)                                                   â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å…¥å±‚: [batch, combined_dim]                                   â”‚  â”‚
â”‚  â”‚  â€¢ éšè—å±‚: mlp_hidden_sizes (å¦‚ [64, 32])                          â”‚  â”‚
â”‚  â”‚  â€¢ æ¿€æ´»å‡½æ•°: ReLU                                                  â”‚  â”‚
â”‚  â”‚  â€¢ Dropout: é˜²æ­¢è¿‡æ‹Ÿåˆ                                             â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å‡ºå±‚: [batch, 1]                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                            â”‚
â”‚  âœ¨ ä½œç”¨: èåˆæ‰€æœ‰ç‰¹å¾å¹¶è¾“å‡ºæœ€ç»ˆé¢„æµ‹                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              è¾“å‡ºé¢„æµ‹                                      â”‚
â”‚  â€¢ é¢„æµ‹ç»“æœ: [batch] (æ¯åªè‚¡ç¥¨çš„é¢„æµ‹æ”¶ç›Šç‡)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                              å…³é”®ç‰¹æ€§                                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  âœ… æ—¶åºå»ºæ¨¡: RNNæ•æ‰é•¿æœŸä¾èµ–ï¼ŒAttentionå¼ºåŒ–å…³é”®æ—¶é—´ç‚¹                       â•‘
â•‘  âœ… æˆªé¢äº¤äº’: GATå­¦ä¹ è‚¡ç¥¨é—´çš„éçº¿æ€§å…³è”                                      â•‘
â•‘  âœ… çµæ´»é…ç½®: å¯é€‰å›¾ç½‘ç»œã€åŸºæœ¬é¢ã€RNNç±»å‹                                    â•‘
â•‘  âœ… æ¨¡å—åŒ–è®¾è®¡: ä¸‰ä¸ªç‹¬ç«‹å­æ¨¡å—ï¼Œæ˜“äºæµ‹è¯•å’Œæ‰©å±•                               â•‘
â•‘  âœ… ä¸¤ç§GAT: æ”¯æŒè¡Œä¸šå’Œç›¸å…³æ€§ä¸¤ç§é‚»æ¥çŸ©é˜µ                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
"""
    
    print(architecture)


def print_config_example():
    """æ‰“å°é…ç½®ç¤ºä¾‹"""
    
    config = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                            é…ç½®ç¤ºä¾‹                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          é»˜è®¤é…ç½® (Default)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ—¶åºæ¨¡å—:                                                                 â”‚
â”‚    rnn_type: 'lstm'                                                       â”‚
â”‚    rnn_hidden: 64                                                         â”‚
â”‚    rnn_layers: 2                                                          â”‚
â”‚    use_attention: True                                                    â”‚
â”‚                                                                            â”‚
â”‚  æˆªé¢æ¨¡å—:                                                                 â”‚
â”‚    use_graph: True                                                        â”‚
â”‚    gat_type: 'standard'                                                   â”‚
â”‚    gat_hidden: 32                                                         â”‚
â”‚    gat_heads: 4                                                           â”‚
â”‚                                                                            â”‚
â”‚  èåˆæ¨¡å—:                                                                 â”‚
â”‚    mlp_hidden_sizes: [64]                                                 â”‚
â”‚                                                                            â”‚
â”‚  è®­ç»ƒå‚æ•°:                                                                 â”‚
â”‚    n_epochs: 100                                                          â”‚
â”‚    batch_size: 256                                                        â”‚
â”‚    learning_rate: 0.001                                                   â”‚
â”‚    dropout: 0.3                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å°å‹é…ç½® (Small)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  rnn_hidden: 32    â”‚  gat_hidden: 16    â”‚  n_epochs: 50                  â”‚
â”‚  rnn_layers: 1     â”‚  gat_heads: 2      â”‚  mlp: [32]                     â”‚
â”‚                                                                            â”‚
â”‚  ğŸ’¡ é€‚ç”¨åœºæ™¯: å¿«é€Ÿå®éªŒã€èµ„æºå—é™                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å¤§å‹é…ç½® (Large)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  rnn_hidden: 128   â”‚  gat_hidden: 64    â”‚  n_epochs: 200                 â”‚
â”‚  rnn_layers: 3     â”‚  gat_heads: 8      â”‚  mlp: [128, 64]                â”‚
â”‚                                                                            â”‚
â”‚  ğŸ’¡ é€‚ç”¨åœºæ™¯: è¿½æ±‚æœ€ä½³æ€§èƒ½ã€GPUèµ„æºå……è¶³                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
"""
    
    print(config)


def print_usage_flow():
    """æ‰“å°ä½¿ç”¨æµç¨‹"""
    
    flow = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                            ä½¿ç”¨æµç¨‹                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Step 1: å‡†å¤‡é‚»æ¥çŸ©é˜µ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from model.utils.adj_matrix_builder import AdjMatrixBuilder

builder = AdjMatrixBuilder()

# æ–¹å¼1: åŸºäºè¡Œä¸š
adj = builder.build_industry_adj(industry_codes)

# æ–¹å¼2: åŸºäºç›¸å…³æ€§
adj = builder.build_correlation_adj(returns, top_k=10)

builder.save_adj_matrix(adj, 'adj_matrix.pt')


Step 2: å‡†å¤‡æ•°æ®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
import torch
from torch.utils.data import TensorDataset, DataLoader

# é‡ä»·æ•°æ®
X_train = torch.randn(1000, 40, 20)  # [æ ·æœ¬æ•°, æ—¶é—´æ­¥, ç‰¹å¾æ•°]
y_train = torch.randn(1000)

# åŸºæœ¬é¢æ•°æ® (å¯é€‰)
F_train = torch.randn(1000, 10)

# åˆ›å»º DataLoader
if use_fundamentals:
    dataset = TensorDataset(X_train, F_train, y_train)
else:
    dataset = TensorDataset(X_train, y_train)

train_loader = DataLoader(dataset, batch_size=256, shuffle=True)


Step 3: åˆ›å»ºæ¨¡å‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from model import HybridGraphModel

model = HybridGraphModel(
    d_feat=20,              # è¾“å…¥ç‰¹å¾ç»´åº¦
    rnn_hidden=64,          # RNNéšè—å±‚
    rnn_layers=2,           # RNNå±‚æ•°
    use_attention=True,     # ä½¿ç”¨Attention
    use_graph=True,         # ä½¿ç”¨å›¾ç½‘ç»œ
    gat_hidden=32,          # GATéšè—å±‚
    gat_heads=4,            # GATå¤´æ•°
    funda_dim=10,           # åŸºæœ¬é¢ç»´åº¦ (å¯é€‰)
    adj_matrix_path='adj_matrix.pt',  # é‚»æ¥çŸ©é˜µè·¯å¾„
    n_epochs=100,
    lr=0.001
)


Step 4: è®­ç»ƒæ¨¡å‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
model.fit(train_loader, valid_loader, save_path='best_model.pth')


Step 5: é¢„æµ‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
predictions = model.predict(test_loader)


Step 6: è¯„ä¼°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
from sklearn.metrics import mean_squared_error, r2_score

mse = mean_squared_error(y_test, predictions)
r2 = r2_score(y_test, predictions)

print(f"MSE: {mse:.6f}")
print(f"RÂ²: {r2:.6f}")
"""
    
    print(flow)


def main():
    """ä¸»å‡½æ•°"""
    print("\n")
    print_architecture()
    print("\n")
    print_config_example()
    print("\n")
    print_usage_flow()
    print("\n")
    print("=" * 80)
    print("ğŸ“š æ›´å¤šä¿¡æ¯:")
    print("  - è¯¦ç»†æ–‡æ¡£: README_HYBRID_GRAPH.md")
    print("  - å®‰è£…æŒ‡å—: INSTALL.md")
    print("  - ä½¿ç”¨ç¤ºä¾‹: example_hybrid_graph.py")
    print("=" * 80)
    print("\n")


if __name__ == '__main__':
    main()
